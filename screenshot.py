import subprocess
import sys
import time
from selenium import webdriver
from PIL import Image

def install_packages():
    try:
        subprocess.check_call([sys.executable, '-m', 'pip', 'install', 'selenium', 'Pillow'])
        print("Packages installed successfully.")
    except subprocess.CalledProcessError as e:
        print(f"Error installing packages: {e}")
    except Exception as e:
        print(f"An unexpected error occurred: {e}")

def capture_screenshot(url, output_directory=".", file_prefix="screenshot"):
    try:
        
        driver = webdriver.Chrome()

        driver.get(url)

        driver.implicitly_wait(5)

        timestamp = time.strftime("%Y%m%d_%H%M%S")
        file_name = f"{file_prefix}_{timestamp}.png"
        output_path = f"{output_directory}/{file_name}"
        driver.save_screenshot(output_path)

        print(f"Screenshot saved to {output_path}")

    except Exception as e:
        print(f"Error capturing screenshot: {e}")

    finally:
        # Close the WebDriver
        driver.quit()

if __name__ == "__main__":
    install_packages()

    target_url = "https://twitter.com/?lang=id"

    output_directory = "D:/ss"

    file_prefix = "screenshot.png"

    capture_screenshot(target_url, output_directory, file_prefix)
